Concept focus: Date functions, grouping by derived columns, logic-based segmentation
Practice:

1. First purchase month for each customer (cohort).
1. select customer_id, min(month(order_date)) as first_purchase_month from orders
group by customer_id

2. Number of customers who ordered in both Jan & Feb 2024 (retention).
2. with cte1 as (select customer_id, month(order_date) as mn from orders),
cte2 as (select cte1.customer_id, cte1.mn from cte1 where cte1.customer_id in (select cte1.customer_id, cte1.mn from cte1 where mn = 1)
and cte.mn = 2)
select count(distinct cte2.customer_id) from cte2

3. Total orders per cohort month.(The month in which a customer placed their first-ever order)
3. with cte1 as (select customer_id, min(month(order_date) as first_month from orders
group by customer_id)
select orders.customer_id, count(orders.order_id) from orders join cte1 on orders.customer_id = cte1.customer_id
group by customer_id
having month(orders.order_date) = cte1.first_month

4. Categorize customers into Platinum / Gold / Silver tiers by total spend.
4. select orders.customer_id, case
when sum(orders.order_amount) > 10000 then 'Platinum'
when sum(orders.order_amount) between 5000 and 10000 then 'Gold'
else 'silver'
end as customer_category
from orders
group by customer_id
order by sum(orders.order_amount) desc

5. Find churned customers (ordered in 2024 but not in 2025).
5. with cte1 as (select customer_id, year(order_date) as yr from orders)
select cte1.customer_id, cte1.yr from cte1 where cte1.customer_id not in (select cte1.customer_id, cte1.yr from cte1 where yr = 2025)
and cte1.yr = 2024

ðŸ’¡ Explain: How SQL can be used for retention dashboards.
