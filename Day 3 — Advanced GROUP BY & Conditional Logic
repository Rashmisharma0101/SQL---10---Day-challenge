Concept focus: Nested aggregation, multiple grouping columns, conditional sums
Practice:

1. Total revenue per city per month.
1. select customers.city, sum(orders.order_amount) as total, month(orders.order_date) as mn from orders join customers
on orders.customer_id  = customers.customer_id
group by customers.city , month(orders.order_date)
order by sum(orders.order_amount) desc

2. Percentage of orders paid via COD per city.
2. 

3. Calculate total and average amount per category per month.
3. select products.category,  month(orders.order_date) as mn , sum(orders.order_amount) as total, avg(orders.order_amount) as average 
from customers join orders
on customers.customer_id = orders.customer_id
join order_items
on order_items.order_id = orders.order_id
join products
on products.product_id = order_items.product_id
group by products.category , month(orders.order_date)
order by sum(orders.order_amount) desc

4. Identify top city by revenue each month.
4. 

5. Find customers who purchased only from one category.
5. select customer_id, count(distinct category) as cnt
from customers join orders
on customers.customer_id = orders.customer_id
join order_items
on order_items.order_id = orders.order_id
join products
on products.product_id = order_items.product_id
group by customer_id
having count(distinct category)  = 1


